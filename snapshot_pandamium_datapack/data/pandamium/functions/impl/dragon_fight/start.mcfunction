scoreboard players set <dragon_fight> global 1

team join dragon_fight @e[type=ender_dragon]
data merge entity @e[type=ender_dragon,limit=1] {CustomName:'{"text":"Ender Dragon","bold":true,"color":"dark_purple"}'}

execute in the_end run summon phantom 0 90 20 {Size:8,PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:120d,Name:"minecraft:generic.max_health"}],Health:120f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight",DeathLootTable:"minecraft:blocks/diamond_ore"}
execute in the_end run summon phantom 0 90 -20 {Size:8,PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:120d,Name:"minecraft:generic.max_health"}],Health:120f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight",DeathLootTable:"pandamium:items/custom/blindness_splash_potion"}
execute in the_end run summon phantom 20 90 0 {Size:8,PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:120d,Name:"minecraft:generic.max_health"}],Health:120f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight",DeathLootTable:"minecraft:blocks/diamond_ore"}
execute in the_end run summon phantom -20 90 0 {Size:8,PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:120d,Name:"minecraft:generic.max_health"}],Health:120f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight",DeathLootTable:"pandamium:items/custom/blindness_splash_potion"}
execute in the_end run summon phantom 0 110 20 {Size:8,PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:120d,Name:"minecraft:generic.max_health"}],Health:120f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight",DeathLootTable:"minecraft:blocks/diamond_ore"}
execute in the_end run summon phantom 0 110 -20 {Size:8,PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:120d,Name:"minecraft:generic.max_health"}],Health:120f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight",DeathLootTable:"pandamium:items/custom/blindness_splash_potion"}
execute in the_end run summon phantom 20 110 0 {Size:8,PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:120d,Name:"minecraft:generic.max_health"}],Health:120f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight",DeathLootTable:"minecraft:blocks/diamond_ore"}
execute in the_end run summon phantom -20 110 0 {Size:8,PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:120d,Name:"minecraft:generic.max_health"}],Health:120f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight",DeathLootTable:"pandamium:items/custom/blindness_splash_potion"}

execute in the_end run summon bat 0 90 20 {PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:1d,Name:"minecraft:generic.max_health"}],Health:1f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight"}
execute in the_end run summon bat 0 90 -20 {PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:1d,Name:"minecraft:generic.max_health"}],Health:1f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight"}
execute in the_end run summon bat 20 90 0 {PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:1d,Name:"minecraft:generic.max_health"}],Health:1f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight"}
execute in the_end run summon bat -20 90 0 {PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:1d,Name:"minecraft:generic.max_health"}],Health:1f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight"}
execute in the_end run summon bat 0 110 20 {PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:1d,Name:"minecraft:generic.max_health"}],Health:1f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight"}
execute in the_end run summon bat 0 110 -20 {PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:1d,Name:"minecraft:generic.max_health"}],Health:1f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight"}
execute in the_end run summon bat 20 110 0 {PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:1d,Name:"minecraft:generic.max_health"}],Health:1f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight"}
execute in the_end run summon bat -20 110 0 {PersistenceRequired:1b,Passengers:[{id:"minecraft:end_crystal",ShowBottom:false,Tags:["dragon_fight"]}],Attributes:[{Base:1d,Name:"minecraft:generic.max_health"}],Health:1f,CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight"}

execute in the_end run summon warden 0 64 0 {PersistenceRequired:1b,Brain:{memories:{"minecraft:dig_cooldown":{ttl:1200L,value:{}},"minecraft:is_emerging":{ttl:134L,value:{}}}},CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight",DeathLootTable:"minecraft:blocks/diamond_ore"}
execute in the_end run summon warden 0 64 0 {PersistenceRequired:1b,Brain:{memories:{"minecraft:dig_cooldown":{ttl:1200L,value:{}},"minecraft:is_emerging":{ttl:134L,value:{}}}},CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight",DeathLootTable:"pandamium:items/custom/blindness_splash_potion"}
execute in the_end run summon warden 0 64 0 {PersistenceRequired:1b,Brain:{memories:{"minecraft:dig_cooldown":{ttl:1200L,value:{}},"minecraft:is_emerging":{ttl:134L,value:{}}}},CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight",DeathLootTable:"minecraft:blocks/diamond_ore"}
execute in the_end run summon warden 0 64 0 {PersistenceRequired:1b,Brain:{memories:{"minecraft:dig_cooldown":{ttl:1200L,value:{}},"minecraft:is_emerging":{ttl:134L,value:{}}}},CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight",DeathLootTable:"pandamium:items/custom/blindness_splash_potion"}
execute in the_end run summon warden 0 64 0 {PersistenceRequired:1b,Brain:{memories:{"minecraft:dig_cooldown":{ttl:1200L,value:{}},"minecraft:is_emerging":{ttl:134L,value:{}}}},CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight",DeathLootTable:"minecraft:blocks/diamond_ore"}
execute in the_end run summon warden 0 64 0 {PersistenceRequired:1b,Brain:{memories:{"minecraft:dig_cooldown":{ttl:1200L,value:{}},"minecraft:is_emerging":{ttl:134L,value:{}}}},CustomName:'"Dragon\'s Henchman"',Tags:["dragon_fight"],Team:"dragon_fight",DeathLootTable:"pandamium:items/custom/blindness_splash_potion"}
execute in the_end positioned 0 64 0 run spreadplayers 0 0 30 40 false @e[type=warden,distance=..100]
execute in the_end positioned 0 64 0 at @e[type=warden,distance=..100] run place feature sculk_patch_deep_dark

execute in the_end as @e[x=0,y=64,z=0,distance=..100,type=warden] store result entity @s Attributes[{Name:"minecraft:generic.scale"}].Base double 0.1 store result entity @s Attributes[{Name:"minecraft:generic.max_health"}].Base double 50 store result entity @s Health float 50 run random value 8..12

scoreboard players reset <dragon_fight_spawned_reinforcements> global
function pandamium:impl/dragon_fight/loop_dragon
