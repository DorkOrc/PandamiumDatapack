# arguments: id

function pandamium:utils/database/click_events/load_new
data modify storage pandamium.db.click_events:io selected.entry.owner.id set from storage pandamium:queue selected.entry.source
function pandamium:utils/database/click_events/modify/set_trigger {trigger: "search_nearby"}
data modify storage pandamium.db.click_events:io selected.entry.data.type set value "teleport"
data modify storage pandamium.db.click_events:io selected.entry.data.home_data.x set from storage pandamium:queue selected.entry.homes[-1].xyz[0]
data modify storage pandamium.db.click_events:io selected.entry.data.home_data.y set from storage pandamium:queue selected.entry.homes[-1].xyz[1]
data modify storage pandamium.db.click_events:io selected.entry.data.home_data.z set from storage pandamium:queue selected.entry.homes[-1].xyz[2]
data modify storage pandamium.db.click_events:io selected.entry.data.home_data.dimension set from storage pandamium:queue selected.entry.origin.dimension
data modify storage pandamium.db.click_events:io selected.entry.data.home_data.owner.id set from storage pandamium:queue selected.entry.homes[-1].data[0]
data modify storage pandamium.db.click_events:io selected.entry.data.home_data.home_slot set from storage pandamium:queue selected.entry.homes[-1].data[1]

scoreboard players set <hour_id> variable 0
execute store result score <hour_id> variable run data get storage pandamium:queue selected.entry.homes[-1].time
function pandamium:utils/get/date/from_hour_id_score

$execute if score <hour_id> variable matches 1.. run data modify storage pandamium:text input set value {text:"",extra:[{text:"‚Ä¢ ",color:"gray"},{text:"[üëÅ]",color:"yellow",click_event:{action:"run_command",command:"trigger homes set $(id)"},hover_event:{action:"show_text",value:{color:"yellow",text:"Click to view ",extra:[{storage:"pandamium:temp",nbt:"display_name",interpret:true},{text:"'s homes"}]}}},{text:" "},{storage:"pandamium.db.click_events:io",nbt:"selected.entry.click_event_root",interpret:true,extra:[{text:"[‚Üí]",color:"blue",hover_event:{action:"show_text",value:{color:"blue",text:"Click to teleport to ",extra:[{storage:"pandamium:temp",nbt:"display_name",interpret:true},{text:"'s Home "},{storage:"pandamium:queue",nbt:"selected.entry.homes[-1].data[1]"}]}}}]},{text:" "},{color:"aqua",text:"",extra:[{storage:"pandamium:temp",nbt:"display_name",interpret:true}]},{text:"'s ",color:"gray"},{text:"Home "},{storage:"pandamium:queue",nbt:"selected.entry.homes[-1].data[1]"},{color:"gray",text:" ",extra:[{score:{name:"<distance>",objective:"variable"}},{text:"m away "}]},{text:"‚Ñπ",color:"blue",hover_event:{action:"show_text",value:{storage:"pandamium:queue",nbt:"selected.entry.homes[-1].xyz[]",separator:" ",extra:[{text:"\nClick to copy to clipboard\nShift+Click to insert into chat",color:"gray"},{text:"\n\nTime Set:\n"},{score:{name:"<day>",objective:"variable"},color:"gray",extra:[{text:"/"},{score:{name:"<month>",objective:"variable"}},{text:"/"},{score:{name:"<year>",objective:"variable"}},{text:" at ‚âà"},{score:{name:"<hour>",objective:"variable"}},{text:":00"}]}]}},click_event:{action:"copy_to_clipboard",value:"$(x) $(y) $(z)"},insertion:"$(x) $(y) $(z)"}]}
$execute unless score <hour_id> variable matches 1.. run data modify storage pandamium:text input set value {text:"",extra:[{text:"‚Ä¢ ",color:"gray"},{text:"[üëÅ]",color:"yellow",click_event:{action:"run_command",command:"trigger homes set $(id)"},hover_event:{action:"show_text",value:{color:"yellow",text:"Click to view ",extra:[{storage:"pandamium:temp",nbt:"display_name",interpret:true},{text:"'s homes"}]}}},{text:" "},{storage:"pandamium.db.click_events:io",nbt:"selected.entry.click_event_root",interpret:true,extra:[{text:"[‚Üí]",color:"blue",hover_event:{action:"show_text",value:{color:"blue",text:"Click to teleport to ",extra:[{storage:"pandamium:temp",nbt:"display_name",interpret:true},{text:"'s Home "},{storage:"pandamium:queue",nbt:"selected.entry.homes[-1].data[1]"}]}}}]},{text:" "},{color:"aqua",text:"",extra:[{storage:"pandamium:temp",nbt:"display_name",interpret:true}]},{text:"'s ",color:"gray"},{text:"Home "},{storage:"pandamium:queue",nbt:"selected.entry.homes[-1].data[1]"},{color:"gray",text:" ",extra:[{score:{name:"<distance>",objective:"variable"}},{text:"m away "}]},{text:"‚Ñπ",color:"blue",hover_event:{action:"show_text",value:{storage:"pandamium:queue",nbt:"selected.entry.homes[-1].xyz[]",separator:" ",extra:[{text:"\nClick to copy to clipboard\nShift+Click to insert into chat",color:"gray"},{text:"\n\nTime Set:\n"},{text:"Before 22/05/2024",color:"gray"}]}},click_event:{action:"copy_to_clipboard",value:"$(x) $(y) $(z)"},insertion:"$(x) $(y) $(z)"}]}
function pandamium:utils/text/input/resolve
data modify entity @s data.text set from storage pandamium:text input

function pandamium:utils/database/click_events/save
